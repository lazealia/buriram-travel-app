<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= restaurant ? restaurant.serviceName : 'รายละเอียด' %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
    <style> 
        body { font-family: 'Kanit', sans-serif; }
        .detail-content p { margin-bottom: 1rem; color: #4b5563; line-height: 1.6; }
    </style>
</head>
<body class="bg-white pb-28">

    <% if (restaurant) { %>
        <div class="relative h-[40vh] w-full overflow-hidden">
            <img src="<%= restaurant.serviceImage %>" 
                 class="w-full h-full object-cover"
                 onerror="this.src='https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&q=80'">
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
            
            <a href="/restaurants" class="absolute top-8 left-5 w-10 h-10 flex items-center justify-center bg-white/20 backdrop-blur-md rounded-xl text-white active:scale-90 transition-transform border border-white/30">
                <i class="fa-solid fa-chevron-left"></i>
            </a>
        </div>

        <main class="relative -mt-12 px-6 bg-white rounded-t-[45px] pt-10 min-h-[60vh]">
            <div class="flex flex-col gap-6">
                
                <div class="flex justify-between items-center">
                    <span class="bg-indigo-50 text-indigo-600 px-4 py-1 rounded-full text-[10px] font-bold uppercase border border-indigo-100">
                        <i class="fa-solid fa-utensils mr-1"></i> <%= restaurant.serviceType %>
                    </span>
                    <span class="text-[10px] font-bold text-gray-400 bg-gray-50 px-3 py-1 rounded-full">
                        ID: <%= restaurant.serviceId %>
                    </span>
                </div>

                <h1 class="text-2xl font-black text-gray-900 leading-tight">
                    <%= restaurant.serviceName %>
                </h1>

                <% if (restaurant.serviceDetail) { %>
                <div class="bg-gray-50/50 p-5 rounded-[30px] border border-gray-100">
                    <h2 class="text-sm font-bold text-gray-800 mb-3 flex items-center gap-2">
                        <i class="fa-solid fa-circle-info text-indigo-500"></i> รายละเอียดร้าน
                    </h2>
                    <div class="detail-content text-sm">
                        <%- restaurant.serviceDetail %>
                    </div>
                </div>
                <% } %>

                <div class="space-y-3">
                    <div class="flex items-start gap-4 p-4 bg-white rounded-3xl border border-gray-100 shadow-sm">
                        <div class="w-10 h-10 rounded-2xl bg-red-50 text-red-500 flex items-center justify-center flex-shrink-0">
                            <i class="fa-solid fa-location-dot"></i>
                        </div>
                        <div class="text-xs">
                            <p class="font-bold text-gray-800 mb-1">ที่อยู่</p>
                            <p class="text-gray-500 leading-relaxed">
                                <%= restaurant.serviceContact.Location.Address %> 
                                ต.<%= restaurant.serviceContact.Location.SubDistrictName.trim() %> 
                                อ.<%= restaurant.serviceContact.Location.DistrictName.trim() %> 
                                จ.<%= restaurant.serviceContact.Location.ProvinceName %>
                            </p>
                        </div>
                    </div>
                    
                    <% if (restaurant.serviceContact.Telephone && restaurant.serviceContact.Telephone.length < 15) { %>
                    <div class="flex items-center gap-4 p-4 bg-white rounded-3xl border border-gray-100 shadow-sm">
                        <div class="w-10 h-10 rounded-2xl bg-green-50 text-green-500 flex items-center justify-center flex-shrink-0">
                            <i class="fa-solid fa-phone"></i>
                        </div>
                        <div class="text-xs">
                            <p class="font-bold text-gray-800 mb-1">เบอร์โทรศัพท์</p>
                            <a href="tel:<%= restaurant.serviceContact.Telephone %>" class="text-indigo-600 font-bold"><%= restaurant.serviceContact.Telephone %></a>
                        </div>
                    </div>
                    <% } %>
                </div>

                <div class="grid grid-cols-2 gap-4 pt-2">
                    <a href="https://www.google.com/maps/search/?api=1&query=<%= restaurant.serviceContact.Location.Latitude %>,<%= restaurant.serviceContact.Location.Longitude %>" 
                       target="_blank"
                       class="flex flex-col items-center justify-center gap-2 bg-indigo-600 text-white p-5 rounded-[30px] shadow-lg shadow-indigo-100 active:scale-95 transition-all">
                        <i class="fa-solid fa-map-location-dot text-xl"></i>
                        <span class="text-[11px] font-bold">เปิดแผนที่นำทาง</span>
                    </a>

                    <button onclick="window.share()" 
                            class="flex flex-col items-center justify-center gap-2 bg-gray-900 text-white p-5 rounded-[30px] shadow-lg shadow-gray-200 active:scale-95 transition-all">
                        <i class="fa-solid fa-share-nodes text-xl"></i>
                        <span class="text-[11px] font-bold">แชร์ให้เพื่อน</span>
                    </button>
                </div>

            </div>
        </main>
    <% } else { %>
        <div class="flex flex-col items-center justify-center h-screen px-10 text-center">
            <div class="w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mb-4">
                <i class="fa-solid fa-utensils text-gray-200 text-3xl"></i>
            </div>
            <h3 class="text-lg font-bold text-gray-800">ไม่พบข้อมูล</h3>
            <p class="text-gray-400 text-sm mt-2">ขออภัย ไม่พบข้อมูลร้านอาหารที่คุณต้องการ หรืออาจจะถูกย้ายไปแล้ว</p>
            <a href="/restaurants" class="mt-8 bg-indigo-600 text-white px-8 py-3 rounded-2xl font-bold shadow-lg shadow-indigo-100">กลับหน้ารวม</a>
        </div>
    <% } %>

    <%- include('partials/nav', { currentPage: 'services' }) %>

    <script>
        window.share = function() {
            if (navigator.share) {
                navigator.share({
                    title: '<%= restaurant ? restaurant.serviceName : "" %>',
                    text: 'แนะนำร้านอาหาร: <%= restaurant ? restaurant.serviceName : "" %>',
                    url: window.location.href
                });
            } else {
                alert('Copy ลิงก์เพื่อแชร์: ' + window.location.href);
            }
        }
    </script>
</body>
</html>