<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รายละเอียดกิจกรรม</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
    <style> body { font-family: 'Kanit', sans-serif; } </style>
</head>
<body class="bg-white pb-28">

    <% if (activity && activity.service) { %>
        <div class="relative h-[40vh] w-full overflow-hidden">
            <img src="<%= activity.service.serviceImage %>" 
                 class="w-full h-full object-cover"
                 onerror="this.src='https://images.unsplash.com/photo-1533900298318-6b8da08a523e?w=800&q=80'">
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
            
            <a href="/activities" class="absolute top-8 left-5 w-10 h-10 flex items-center justify-center bg-white/20 backdrop-blur-md rounded-xl text-white active:scale-90 transition-transform">
                <i class="fa-solid fa-chevron-left"></i>
            </a>
        </div>

        <main class="relative -mt-10 px-6 bg-white rounded-t-[40px] pt-8">
            <div class="flex flex-col gap-5">
                
                <div class="flex justify-between items-start">
                    <div>
                        <% if(activity.activityGroup) { %>
                        <span class="bg-indigo-50 text-indigo-600 px-3 py-1 rounded-full text-[10px] font-bold uppercase border border-indigo-100">
                            <i class="fa-solid fa-star mr-1"></i> <%= activity.activityGroup.activity_group_name %>
                        </span>
                        <% } %>
                        <h1 class="text-2xl font-black text-gray-900 mt-2">
                            <%= activity.service.serviceName %>
                        </h1>
                    </div>
                    <div class="text-right">
                        <p class="text-[9px] text-gray-400 font-bold uppercase">ราคา</p>
                        <p class="text-xl font-black text-indigo-600">
                            <%= (activity.service.servicePrice && activity.service.servicePrice > 0) ? '฿' + activity.service.servicePrice : 'ฟรี/สอบถาม' %>
                        </p>
                    </div>
                </div>

                <div class="flex items-start gap-3 text-gray-500 text-sm">
                    <i class="fa-solid fa-location-dot mt-1 text-red-500"></i>
                    <div>
                        <p class="font-bold text-gray-800"><%= activity.community.community_name %></p>
                        <p class="text-xs leading-relaxed">
                            <%= activity.service.serviceAddressDetail || activity.community.community_address %> 
                            ต.<%= activity.community.tambon_name.trim() %> อ.<%= activity.community.amphur_name.trim() %> 
                            จ.<%= activity.community.province_name %>
                        </p>
                    </div>
                </div>

                <hr class="border-gray-100">

                <div>
                    <h2 class="text-lg font-bold text-gray-800 mb-2">เกี่ยวกับกิจกรรมนี้</h2>
                    <div class="text-gray-600 text-sm leading-relaxed">
                        <%- activity.service.serviceDetail || 'เชิญร่วมสัมผัสประสบการณ์ ' + activity.service.serviceName + ' เรียนรู้วิถีชุมชนและสนุกไปกับการลงมือทำด้วยตัวเอง' %>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-[30px] p-6 border border-gray-100 mt-2">
                    <h3 class="text-sm font-bold text-gray-800 mb-4">ติดต่อชุมชน/ผู้จัด</h3>
                    <div class="space-y-3">
                        <% if(activity.community.community_telephone) { %>
                        <a href="tel:<%= activity.community.community_telephone %>" class="flex items-center gap-4 bg-white p-3 rounded-2xl shadow-sm">
                            <div class="w-10 h-10 bg-green-500 text-white rounded-xl flex items-center justify-center">
                                <i class="fa-solid fa-phone text-sm"></i>
                            </div>
                            <div>
                                <p class="text-[10px] text-gray-400 font-bold uppercase">เบอร์โทรศัพท์</p>
                                <p class="text-sm font-bold text-gray-700"><%= activity.community.community_telephone %></p>
                            </div>
                        </a>
                        <% } %>

                        <% if(activity.community.community_email) { %>
                        <div class="flex items-center gap-4 bg-white p-3 rounded-2xl shadow-sm">
                            <div class="w-10 h-10 bg-indigo-500 text-white rounded-xl flex items-center justify-center">
                                <i class="fa-solid fa-envelope text-sm"></i>
                            </div>
                            <div class="overflow-hidden">
                                <p class="text-[10px] text-gray-400 font-bold uppercase">อีเมล</p>
                                <p class="text-sm font-bold text-gray-700 truncate"><%= activity.community.community_email %></p>
                            </div>
                        </div>
                        <% } %>
                    </div>
                </div>

                <a href="https://www.google.com/maps/search/?api=1&query=<%= activity.service.serviceLatitude %>,<%= activity.service.serviceLongitude %>" 
                   target="_blank"
                   class="flex items-center justify-center gap-2 bg-indigo-600 text-white py-4 rounded-[25px] font-bold shadow-lg shadow-indigo-100 active:scale-95 transition-all">
                    <i class="fa-solid fa-map-location-dot"></i>
                    <span>ดูแผนที่และนำทาง</span>
                </a>

            </div>
        </main>
    <% } else { %>
        <div class="flex flex-col items-center justify-center h-screen">
            <p class="text-gray-400">ไม่พบข้อมูลกิจกรรม</p>
            <a href="/activities" class="mt-4 text-indigo-600 font-bold">กลับหน้ารวม</a>
        </div>
    <% } %>

    <%- include('partials/nav', { currentPage: 'services' }) %>

</body>
</html>